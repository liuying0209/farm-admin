(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e0f6fc3"],{"189d":function(a,t,e){},"2c36":function(a,t,e){"use strict";e.r(t);var r=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{class:a.pageName},[e("div",{class:a.pageName+"-form"},[e("Select",{staticStyle:{width:"150px","margin-right":"10px"},attrs:{placeholder:"请选择农场"},on:{"on-change":a.onChangeFarmType1},model:{value:a.params.farmId,callback:function(t){a.$set(a.params,"farmId",t)},expression:"params.farmId"}},a._l(a.optionFarm,function(t){return e("Option",{key:t.id,attrs:{value:t.id}},[a._v(a._s(t.name))])}),1),e("Select",{staticStyle:{width:"150px","margin-right":"10px"},attrs:{placeholder:"请选择地块"},on:{"on-change":a.onChangeFarmType2},model:{value:a.params.plotId,callback:function(t){a.$set(a.params,"plotId",t)},expression:"params.plotId"}},a._l(a.optionFarmPlan,function(t){return e("Option",{key:t.id,attrs:{value:t.id}},[a._v(a._s(t.name))])}),1),e("Select",{staticStyle:{width:"150px","margin-right":"10px"},attrs:{placeholder:"请选择作物"},on:{"on-change":a.onChangeFarmType3},model:{value:a.params.cropId,callback:function(t){a.$set(a.params,"cropId",t)},expression:"params.cropId"}},a._l(a.optionCrops,function(t){return e("Option",{key:t.id,attrs:{value:t.id}},[a._v(a._s(t.name))])}),1),e("Select",{staticStyle:{width:"150px","margin-right":"10px"},attrs:{placeholder:"请选择批次"},model:{value:a.params.plotCropId,callback:function(t){a.$set(a.params,"plotCropId",t)},expression:"params.plotCropId"}},a._l(a.optionBatch,function(t){return e("Option",{key:t.id,attrs:{value:t.id}},[a._v(a._s(t.name))])}),1),e("Select",{staticStyle:{width:"150px","margin-right":"10px"},attrs:{placeholder:"请选择年份"},model:{value:a.params.year,callback:function(t){a.$set(a.params,"year",t)},expression:"params.year"}},a._l(a.optionYear,function(t){return e("Option",{key:t,attrs:{value:t}},[a._v(a._s(t))])}),1),e("i-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",icon:"ios-search"},on:{click:a.search}},[a._v("查询")]),e("i-button",{attrs:{type:"primary"},on:{click:a.exportExcel}},[a._v("导出")])],1),e("div",{class:a.pageName+"-data"},[e("Table",{attrs:{loading:a.loading,border:"",columns:a.dataColumns,data:a.dataList},scopedSlots:a._u([{key:"time",fn:function(t){var r=t.row;return[e("div",[e("span",{class:{"is-change-time":new Date(r.time).getTime()!=new Date(r.updateTime).getTime()}},[a._v(a._s(r.time))])])]}},{key:"images",fn:function(t){var r=t.row;return[e("div",{staticClass:"data-images"},a._l(r.images,function(t,s){return e("img",{key:t,attrs:{src:t,alt:"图片"+(s+1)},on:{click:function(t){return a.auditingRecord(r)}}})}),0)]}},{key:"detail",fn:function(t){var r=t.row;return[e("div",{staticClass:"data-detail"},[e("div",{staticClass:"detail-content"},[a._v(a._s(r.detail))])])]}},{key:"score",fn:function(t){var r=t.row;return[e("div",[r.reason?e("Poptip",{attrs:{trigger:"hover",title:"",content:r.reason}},[e("span",[a._v(a._s(r.score-r.deductMarks))])]):e("span",[a._v(a._s(r.score-r.deductMarks))])],1)]}},{key:"handle",fn:function(t){var r=t.row;return[e("div",[e("Button",{attrs:{size:"small"},on:{click:function(t){return a.handleRecord(r)}}},[a._v("评估")])],1)]}}])}),e("Page",{staticClass:"table-pagination",attrs:{total:a.pagination.total,"page-size":a.pagination.pageSize,size:"small","show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":a.onChange,"on-page-size-change":a.onPageSizeChange}})],1),e("Modal",{class:a.pageName+"-modal",attrs:{width:"850","mask-closable":!1},model:{value:a.auditing.show,callback:function(t){a.$set(a.auditing,"show",t)},expression:"auditing.show"}},[e("div",{attrs:{slot:"header"},slot:"header"}),e("div",{staticClass:"modal-content"},[e("div",{staticClass:"farm-info"},[a._v("\n                "+a._s(a.auditing.farmName)+"    \n                "+a._s(a.auditing.plotName)+"    \n                "+a._s(a.auditing.cropName)+"    \n                "+a._s(a.auditing.cropVariety)+"    \n                "+a._s(a.auditing.farmWorkName)+"    \n            ")]),e("div",{staticClass:"modal-center"},[e("div",{staticClass:"big-img"},[e("swiper",{attrs:{options:a.swiperOption}},[a._l(a.auditing.images,function(a,t){return e("swiper-slide",{key:t},[e("div",{staticClass:"img-title",style:{"background-image":"url("+a+")"}})])}),e("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"})],2)],1),e("div",{staticClass:"auditing-handle"},[e("div",{staticClass:"handle-title"},[a._v("评估")]),e("div",{staticClass:"handle-tip"},[a._v("对图像中农事行为判断（扣分制）")]),e("div",{staticClass:"handle-score"},[e("div",{class:-1===a.auditing.params.deductMarks?"active-score":"",on:{click:function(t){a.auditing.params.deductMarks=-1}}},[a._v("1")]),e("div",{class:-2===a.auditing.params.deductMarks?"active-score":"",on:{click:function(t){a.auditing.params.deductMarks=-2}}},[a._v("2")]),e("div",{class:-3===a.auditing.params.deductMarks?"active-score":"",on:{click:function(t){a.auditing.params.deductMarks=-3}}},[a._v("3")]),e("div",{class:-4===a.auditing.params.deductMarks?"active-score":"",on:{click:function(t){a.auditing.params.deductMarks=-4}}},[a._v("4")]),e("div",{class:-5===a.auditing.params.deductMarks?"active-score":"",on:{click:function(t){a.auditing.params.deductMarks=-5}}},[a._v("5")])]),e("div",{staticClass:"handle-reason"},[e("i-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入..."},model:{value:a.auditing.params.reason,callback:function(t){a.$set(a.auditing.params,"reason",t)},expression:"auditing.params.reason"}})],1),e("div",{staticClass:"handle-question"},[e("Checkbox",{attrs:{checked:a.auditing.params.deductMarksType},on:{"update:checked":function(t){return a.$set(a.auditing.params,"deductMarksType",t)}}},[a._v("标为存疑")])],1),e("div",{staticClass:"handle-button"},[e("i-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",disabled:a.auditing.disabled},on:{click:a.confirm}},[a._v("确认")])],1)])])]),e("div",{attrs:{slot:"footer"},slot:"footer"})]),e("Modal",{class:a.pageName+"-modal",attrs:{width:"332"},model:{value:a.record.show,callback:function(t){a.$set(a.record,"show",t)},expression:"record.show"}},[e("div",{attrs:{slot:"header"},slot:"header"}),e("div",{staticClass:"auditing-handle"},[e("div",{staticClass:"handle-title"},[a._v("选择分数")]),e("div",{staticClass:"handle-score"},[e("div",{class:-1===a.record.params.deductMarks?"active-score":"",on:{click:function(t){a.record.params.deductMarks=-1}}},[a._v("-1")]),e("div",{class:-2===a.record.params.deductMarks?"active-score":"",on:{click:function(t){a.record.params.deductMarks=-2}}},[a._v("-2")]),e("div",{class:-3===a.record.params.deductMarks?"active-score":"",on:{click:function(t){a.record.params.deductMarks=-3}}},[a._v("-3")]),e("div",{class:-4===a.record.params.deductMarks?"active-score":"",on:{click:function(t){a.record.params.deductMarks=-4}}},[a._v("-4")]),e("div",{class:-5===a.record.params.deductMarks?"active-score":"",on:{click:function(t){a.record.params.deductMarks=-5}}},[a._v("-5")])]),e("div",{staticClass:"handle-score"},[e("div",{class:1===a.record.params.deductMarks?"active-score":"",on:{click:function(t){a.record.params.deductMarks=1}}},[a._v("+1")]),e("div",{class:2===a.record.params.deductMarks?"active-score":"",on:{click:function(t){a.record.params.deductMarks=2}}},[a._v("+2")]),e("div",{class:3===a.record.params.deductMarks?"active-score":"",on:{click:function(t){a.record.params.deductMarks=3}}},[a._v("+3")]),e("div",{class:4===a.record.params.deductMarks?"active-score":"",on:{click:function(t){a.record.params.deductMarks=4}}},[a._v("+4")]),e("div",{class:5===a.record.params.deductMarks?"active-score":"",on:{click:function(t){a.record.params.deductMarks=5}}},[a._v("+5")])]),e("div",{staticClass:"handle-reason"},[e("i-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入..."},model:{value:a.record.params.reason,callback:function(t){a.$set(a.record.params,"reason",t)},expression:"record.params.reason"}})],1),e("div",{staticClass:"handle-button"},[e("i-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:a.confirmRecord}},[a._v("确认")])],1)]),e("div",{attrs:{slot:"footer"},slot:"footer"})])],1)},s=[],i=e("cebc"),n=e("8127"),o=e("c276"),c=(e("5118"),e("f121")),d="DataProductRecord",l={name:d,filters:{status:function(a){return 1===a?"已记录":2===a?"未记录":"--"}},data:function(){return{pageName:d,params:{pageNo:1,pageSize:20,farmId:"",cropId:"",plotId:"",plotCropId:"",year:(new Date).getFullYear()},optionYear:Object(o["k"])(),optionFarm:[],optionCrops:[],optionBatch:[],optionFarmPlan:[],dataColumns:[{title:"地块",key:"plotName",minWidth:100},{title:"作物",key:"cropName",minWidth:100},{title:"批次",key:"cropVariety",minWidth:150},{title:"农事环节",key:"farmWorkName",minWidth:120},{title:"农事时间",slot:"time",minWidth:150},{title:"图片",slot:"images",minWidth:200},{title:"详细信息",slot:"detail",minWidth:200},{title:"记录时间",key:"updateTime",minWidth:150},{title:"总得分",slot:"score",minWidth:80},{title:"操作",slot:"handle",minWidth:100}],dataList:[],loading:!1,auditing:{show:!1,farmName:"",plotName:"",cropName:"",cropVariety:"",farmWorkName:"",images:[],disabled:!0,params:{recordId:"",deductMarks:"",deductMarksType:"",reason:""}},swiperOption:{pagination:{el:".swiper-pagination"}},pagination:{total:0,current:1,pageSize:20},record:{show:!1,params:{recordId:"",deductMarks:"",deductMarksType:"",reason:""}}}},created:function(){this.axiosGetDataFarm()},methods:{search:function(){this.axiosGetFarmRecordList(this.params)},exportExcel:function(){var a=this.params.plotId?"&plotId=".concat(this.params.plotId):"",t=this.params.cropId?"&plotId=".concat(this.params.cropId):"",e=this.params.plotCropId?"&plotId=".concat(this.params.plotCropId):"";window.open("".concat(c["a"].baseUrl.pro,"api/record/exportRecord?farmId=").concat(this.params.farmId).concat(a).concat(t).concat(e))},onChangeFarmType1:function(a){this.axiosGetPlan({farmId:a})},onChangeFarmType2:function(a){this.axiosGetCrops({farmId:this.params.farmId,plotId:a})},onChangeFarmType3:function(a){this.axiosGetBatch({farmId:this.params.farmId,plotId:this.params.plotId,cropId:a})},onChange:function(a){this.params.pageNo=a,this.axiosGetFarmRecordList(this.params)},onPageSizeChange:function(a){this.params.pageSize=a,this.params.pageNo=1,this.axiosGetFarmRecordList(this.params)},auditingRecord:function(a){console.log(a);var t={farmName:a.farmName,plotName:a.plotName,cropName:a.cropName,cropVariety:a.cropVariety,farmWorkName:a.farmWorkName,images:a.images,disabled:1===a.assessFlag,params:{recordId:a.recordId,deductMarks:a.deductMarks||"",deductMarksType:a.deductMarksType||"",reason:a.reason||""}};this.auditing=Object(i["a"])({},t,{show:!0})},confirm:function(){""===this.auditing.params.deductMarks||""!==this.auditing.params.reason?(this.auditing.params.deductMarksType=this.auditing.params.deductMarksType?0:2,this.axiosRecordAssess(this.auditing.params)):this.$Message.warning("请填写扣分原因")},handleRecord:function(a){var t={show:!0,params:{recordId:a.recordId,deductMarks:a.deductMarks,deductMarksType:a.deductMarksType,reason:a.reason}};this.record=t},confirmRecord:function(){""===this.record.params.deductMarks||""!==this.record.params.reason?this.axiosRecordUpdateAssess(this.record.params):this.$Message.warning("请填写扣分原因")},axiosGetDataFarm:function(){var a=this;Object(n["b"])().then(function(t){200===t.status&&(a.optionFarm=t.data,a.params.farmId=t.data[0].id,a.axiosGetPlan({farmId:a.params.farmId}))})},axiosGetPlan:function(a){var t=this;Object(n["b"])(a).then(function(a){if(200===a.status){if(t.optionFarmPlan=a.data,0===a.data.length)return t.params.plotId="",t.params.cropId="",void(t.params.plotCropId="");t.params.plotId=a.data[0].id,t.axiosGetCrops({farmId:t.params.farmId,plotId:t.params.plotId})}})},axiosGetCrops:function(a){var t=this;Object(n["b"])(a).then(function(a){if(200===a.status){if(t.optionCrops=a.data,0===a.data.length)return t.params.cropId="",void(t.params.plotCropId="");t.params.cropId=a.data[0].id,t.axiosGetBatch({farmId:t.params.farmId,plotId:t.params.plotId,cropId:t.params.cropId})}})},axiosGetBatch:function(a){var t=this;Object(n["b"])(a).then(function(a){if(200===a.status){if(t.optionBatch=a.data,0===a.data.length)return void(t.params.plotCropId="");t.params.plotCropId=a.data[0].id}})},axiosGetFarmRecordList:function(a){var t=this;Object(n["a"])(a).then(function(a){if(200===a.status){var e=a.data,r=e.list;e.data;t.dataList=r}})},axiosRecordAssess:function(a){var t=this;Object(n["e"])(a).then(function(a){200===a.status&&Object(n["c"])({farmId:t.params.farmId,plotId:t.params.plotId,cropId:t.params.cropId,plotCropId:t.params.plotCropId}).then(function(a){200===a.status&&t.auditingRecord(a.data)})})},axiosRecordUpdateAssess:function(a){var t=this;Object(n["f"])(a).then(function(a){200===a.status&&(t.$Message.success("更新分数成功"),t.record={show:!1,params:{recordId:"",deductMarks:"",deductMarksType:"",reason:""}},t.axiosGetFarmRecordList(t.params))})}}},p=l,u=(e("c131"),e("2877")),m=Object(u["a"])(p,r,s,!1,null,null,null);t["default"]=m.exports},5118:function(a,t,e){(function(a){var r="undefined"!==typeof a&&a||"undefined"!==typeof self&&self||window,s=Function.prototype.apply;function i(a,t){this._id=a,this._clearFn=t}t.setTimeout=function(){return new i(s.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new i(s.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(a){a&&a.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(a,t){clearTimeout(a._idleTimeoutId),a._idleTimeout=t},t.unenroll=function(a){clearTimeout(a._idleTimeoutId),a._idleTimeout=-1},t._unrefActive=t.active=function(a){clearTimeout(a._idleTimeoutId);var t=a._idleTimeout;t>=0&&(a._idleTimeoutId=setTimeout(function(){a._onTimeout&&a._onTimeout()},t))},e("6017"),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof a&&a.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof a&&a.clearImmediate||this&&this.clearImmediate}).call(this,e("c8ba"))},6017:function(a,t,e){(function(a,t){(function(a,e){"use strict";if(!a.setImmediate){var r,s=1,i={},n=!1,o=a.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(a);c=c&&c.setTimeout?c:a,"[object process]"==={}.toString.call(a.process)?m():f()?h():a.MessageChannel?g():o&&"onreadystatechange"in o.createElement("script")?v():k(),c.setImmediate=d,c.clearImmediate=l}function d(a){"function"!==typeof a&&(a=new Function(""+a));for(var t=new Array(arguments.length-1),e=0;e<t.length;e++)t[e]=arguments[e+1];var n={callback:a,args:t};return i[s]=n,r(s),s++}function l(a){delete i[a]}function p(a){var t=a.callback,r=a.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(e,r);break}}function u(a){if(n)setTimeout(u,0,a);else{var t=i[a];if(t){n=!0;try{p(t)}finally{l(a),n=!1}}}}function m(){r=function(a){t.nextTick(function(){u(a)})}}function f(){if(a.postMessage&&!a.importScripts){var t=!0,e=a.onmessage;return a.onmessage=function(){t=!1},a.postMessage("","*"),a.onmessage=e,t}}function h(){var t="setImmediate$"+Math.random()+"$",e=function(e){e.source===a&&"string"===typeof e.data&&0===e.data.indexOf(t)&&u(+e.data.slice(t.length))};a.addEventListener?a.addEventListener("message",e,!1):a.attachEvent("onmessage",e),r=function(e){a.postMessage(t+e,"*")}}function g(){var a=new MessageChannel;a.port1.onmessage=function(a){var t=a.data;u(t)},r=function(t){a.port2.postMessage(t)}}function v(){var a=o.documentElement;r=function(t){var e=o.createElement("script");e.onreadystatechange=function(){u(t),e.onreadystatechange=null,a.removeChild(e),e=null},a.appendChild(e)}}function k(){r=function(a){setTimeout(u,0,a)}}})("undefined"===typeof self?"undefined"===typeof a?this:a:self)}).call(this,e("c8ba"),e("4362"))},8127:function(a,t,e){"use strict";e.d(t,"d",function(){return s}),e.d(t,"a",function(){return i}),e.d(t,"b",function(){return n}),e.d(t,"e",function(){return o}),e.d(t,"f",function(){return c}),e.d(t,"c",function(){return d});var r=e("66df"),s=function(a){return r["a"].request({url:"api/crop/page",method:"get",params:a})},i=function(a){return r["a"].request({url:"api/record/page",method:"get",params:a})},n=function(a){return r["a"].request({url:"api/farm/linkage/menu",method:"get",params:a})},o=function(a){return r["a"].request({url:"api/record/assess",method:"post",data:a})},c=function(a){return r["a"].request({url:"api/record/updateAssess",method:"put",data:a})},d=function(a){return r["a"].request({url:"api/record/next",method:"get",params:a})}},c131:function(a,t,e){"use strict";var r=e("189d"),s=e.n(r);s.a}}]);